{% load static %}
<div class="bg-white bg-card w-100 h-100 py-5">
  <div id="carouselExampleControls" class="carousel slide h-100" data-bs-ride="false" data-bs-wrap="false">

    <div class="carousel-inner text-center">
        
      {% for date, formset in formsets.items %}
        {% include "partials/day-slide.html" with date=date formset=formset %}
      {% endfor %}

    </div>

    <!-- Carousel controls -->
    <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true" style="background-color: rgba(0,0,0,0.5); border-radius: 50%; padding: 10px;"></span>
      <span class="visually-hidden">Previous</span>
    </button>

    <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true" style="background-color: rgba(0,0,0,0.5); border-radius: 50%; padding: 10px;"></span>
      <span class="visually-hidden">Next</span>
    </button>

  </div>
</div>

<script>
    document.querySelectorAll('.checkbox-svg').forEach(svg => {
      const checkMark = svg.querySelector('.check-mark');
      const hiddenInput = document.getElementById(`completed-${svg.dataset.prefix}-${svg.dataset.index}`);
      const isCompleted = hiddenInput.value === "true";
    
      // Initialize mark visibility
      checkMark.style.display = isCompleted ? 'block' : 'none';
        
      svg.addEventListener('click', () => {
        const isCompleted = hiddenInput.value === "true";
        const newState = !isCompleted;
        hiddenInput.value = newState ? 'true' : 'false';
        checkMark.style.display = newState ? 'block' : 'none';
      });
    });
    
    document.querySelectorAll('.title-input').forEach(input => {
        const row = input.closest('.task-row');
        const deleteInput = row.querySelector('input[name$="-DELETE"]');
        const deleteToggle = row.querySelector('.delete-toggle');
        
        if (!deleteInput) return;
        
        deleteToggle.addEventListener('click', () => {
            deleteInput.checked = !deleteInput.checked;
            input.classList.toggle('crossed-out', deleteInput.checked);
        });
    });
    
    
</script>
